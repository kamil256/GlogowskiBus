@model GlogowskiBus.UI.Models.HomeBusPositionsViewModel

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!-- ko if: selectedView().name == 'List' && selectedView().selectedTab() == 'PRZYSTANKI' -->
    <div id="busStopsList">
        <div class="itemsList" data-bind="foreach: busStops.toArray()">
            <div data-bind="click: function() { $root.selectedBusStop($data); return true; }, css: { active: $root.selectedBusStop() == $data }">
                <div>
                    <input data-bind="checked: $root.selectedBusStop() == $data, checkedValue: true" type="radio" />
                </div>
                <div>
                    <p data-bind="text: 'PRZYSTANEK #' + id"></p>
                    <p data-bind="text: 'Nazwa: ' + name()"></p>
                    <p data-bind="text: 'Pozycja: ' + latitude() + ', ' + longitude()"></p>
                    <p data-bind="text: 'Linie: ' + (getAllBusNumbers().join(', ') || '-')"></p>
                    <button class="btn btn-xs btn-default" data-bind="click: function() { $root.busStopsListEditBtnClick($data); }">EDYTUJ</button>
                    <button class="btn btn-xs btn-default" data-bind="click: function() { $root.busStopsListDeleteBtnClick($data); }">USUŃ</button>
                </div>
            </div>
        </div>
        <button class="btn btn-default" data-bind="click: function() { busStopsListAddBtnClick(); }">DODAJ</button>
    </div>
<!-- /ko -->

<!-- ko if: selectedView().name == 'List' && selectedView().selectedTab() == 'LINIE' -->
    <div id="busLinesList">
        <div data-bind="foreach: busLines.toArray()">
            <div>
                <p data-bind="text: 'LINIA #' + id"></p>
                <p data-bind="text: 'Numer autobusu: ' + busNumber()"></p>
                <div class="itemsList" data-bind="foreach: $data.routes.toArray()">
                    <div data-bind="click: function() { $root.selectedRoute($data); return true; }, css: { active: $root.selectedRoute() == $data }">
                        <div>
                            <input data-bind="checked: $root.selectedRoute() == $data, checkedValue: true" type="radio" />
                        </div>
                        <div>
                            <p data-bind="text: 'TRASA #' + id"></p>
                            <p data-bind="text: points.getFirst().busStop.name() + ' - ' + points.getLast().busStop.name()"></p>
                            <p data-bind="text: indexMark() + ' - ' + details(), visible: indexMark() && details()"></p>
                        </div>
                    </div>
                </div>
                <button class="btn btn-xs btn-default">EDYTUJ</button>
                <button class="btn btn-xs btn-default">USUŃ</button>
            </div>
        </div>
        <button class="btn btn-default">DODAJ</button>
    </div>
<!-- /ko -->

<!-- ko if: selectedView().name == 'AddBusStop' && selectedView().selectedTab() == 'DODAWANIE PRZYSTANKU' -->
    <div id="addBusStop">
        <p>NAZWA</p>
        <input class="form-control" data-bind="value: selectedBusStop().name" />

        <p>POZYCJA</p>
        <table style="width: 100%">
            <tr>
                <td>
                    <input class="form-control" data-bind="value: selectedBusStop().latitude" />
                </td>
                <td>
                    <input class="form-control" data-bind="value: selectedBusStop().longitude" />
                </td>
            </tr>
        </table>

        <button class="btn btn-default" data-bind="click: function() { addBusStopAddBtnClick(); }">DODAJ</button>
        <button class="btn btn-default" data-bind="click: function() { addBusStopCancelBtnClick(); }">ANULUJ</button>
    </div>
<!-- /ko -->

<!-- ko if: selectedView().name == 'EditBusStop' && selectedView().selectedTab() == 'EDYTOWANIE PRZYSTANKU' -->
    <div id="editBusStop">
        <p data-bind="text: 'PRZYSTANEK #' + selectedBusStop().id"></p>
    
        <p>NAZWA</p>
        <input class="form-control" data-bind="value: selectedBusStop().name" />

        <p>POZYCJA</p>
        <table style="width: 100%">
            <tr>
                <td>
                    <input class="form-control" data-bind="value: selectedBusStop().latitude" />
                </td>
                <td>
                    <input class="form-control" data-bind="value: selectedBusStop().longitude" />
                </td>
            </tr>
        </table>

        <button class="btn btn-default" data-bind="click: function() { editBusStopEditBtnClick(); }">EDYTUJ</button>
        <button class="btn btn-default" data-bind="click: function() { editBusStopCancelBtnClick(); }">ANULUJ</button>
    </div>
<!-- /ko -->

<!-- ko if: selectedView().name == 'DeleteBusStop' && selectedView().selectedTab() == 'USUWANIE PRZYSTANKU' -->
    <div id="deleteBusStop">
        <p>NAZWA</p>
        <input class="form-control" data-bind="value: selectedBusStop().name" />

        <p>POZYCJA</p>
        <table style="width: 100%">
            <tr>
                <td>
                    <input class="form-control" data-bind="value: selectedBusStop().latitude" />
                </td>
                <td>
                    <input class="form-control" data-bind="value: selectedBusStop().longitude" />
                </td>
            </tr>
        </table>
        <p data-bind="text: 'Linie: ' + (selectedBusStop().getAllBusNumbers().join(', ') || '-')@*busLinesNumbersListForBusStop(selectedBusStop())*@"></p>

        <button class="btn btn-default" data-bind="click: function() { deleteBusStopDeleteBtnClick(); }">USUŃ</button>
        <button class="btn btn-default" data-bind="click: function() { deleteBusStopCancelBtnClick(); }">ANULUJ</button>
    </div>
<!-- /ko -->

<script>
window.onload = function()
{
    markerIcons = new MarkerIcons();
    serverTime = new ServerTime(@Model.ServerTimeMilliseconds);

    administrationContext = new AdministrationContext();
    ko.applyBindings(administrationContext);
}
</script>
